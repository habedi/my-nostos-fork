# expect: 0
# Quicksort implementation

# Append two lists
append([], ys) = ys
append([x | xs], ys) = [x | append(xs, ys)]

# Filter list by predicate
myFilter(_, []) = []
myFilter(p, [h | t]) = if p(h) then [h | myFilter(p, t)] else myFilter(p, t)

# Quicksort
quicksort([]) = []
quicksort([pivot | rest]) = {
    less = myFilter(x => x < pivot, rest)
    greater = myFilter(x => x >= pivot, rest)
    append(quicksort(less), [pivot | quicksort(greater)])
}

main() = {
    assert_eq([1, 2, 3, 4, 5, 6, 7, 8, 9], quicksort([5, 3, 8, 1, 9, 2, 7, 4, 6]))
    0
}
