# expect: 0
# Merge sort implementation

# Split list into two halves
mySplit([]) = ([], [])
mySplit([x]) = ([x], [])
mySplit([x, y | rest]) = {
    (left, right) = mySplit(rest),
    ([x | left], [y | right])
}

# Merge two sorted lists
merge([], ys) = ys
merge(xs, []) = xs
merge([x | xs], [y | ys]) =
    if x <= y
    then [x | merge(xs, [y | ys])]
    else [y | merge([x | xs], ys)]

# Merge sort
mergesort([]) = []
mergesort([x]) = [x]
mergesort(lst) = {
    (left, right) = mySplit(lst)
    merge(mergesort(left), mergesort(right))
}

main() = {
    assert_eq([1, 2, 3, 4, 5, 6], mergesort([4, 2, 6, 1, 5, 3]))
    0
}
