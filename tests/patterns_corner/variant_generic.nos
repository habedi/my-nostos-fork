# expect: 42
# Generic variant patterns (uses stdlib Option)

mapOpt(Some(x), f) = Some(f(x))
mapOpt(None, _) = None

flatMapOpt(Some(x), f) = f(x)
flatMapOpt(None, _) = None

double(x) = x * 2
maybeDouble(x) = if x > 0 then Some(x * 2) else None

main() = {
    assert_eq(Some(10), mapOpt(Some(5), double))
    assert_eq(None, mapOpt(None, double))

    assert_eq(Some(10), flatMapOpt(Some(5), maybeDouble))
    assert_eq(None, flatMapOpt(Some(-5), maybeDouble))
    assert_eq(None, flatMapOpt(None, maybeDouble))
    42
}
