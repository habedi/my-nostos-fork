# expect_error: reads mvar `countdown` and later writes it
# Tests that compare-and-set pattern is detected: read in condition, write in branch.
# This pattern has race conditions and is correctly rejected.

mvar countdown: Int = 100

# Dangerous pattern: reads countdown in condition, writes in branch
decrement() = {
    if countdown > 0 then {
        countdown = countdown - 1
        true
    } else {
        false
    }
}

main() = 0
