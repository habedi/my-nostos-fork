# expect: 27
# Compose three functions with type inference

compose3[A, B, C, D](f: A -> B, g: B -> C, h: C -> D) -> A -> D = x => h(g(f(x)))

main() = {
    triple = x => x * 3
    squared = x => x * x
    addOne = x => x + 1
    # (1 + 1) = 2, then * 3 = 6, then - 5 = 1... wait let me recalc
    # Actually: addOne(1) = 2, triple(2) = 6, but squared would be 36
    # Let me do: triple first, then addOne
    pipeline = compose3(triple, addOne, triple)
    # triple(2) = 6, addOne(6) = 7, triple(7) = 21... hmm
    # Let me simplify: compose3(addOne, addOne, addOne)(0) = 3
    addPipeline = compose3(addOne, addOne, addOne)
    result = addPipeline(0)  # 0+1+1+1 = 3
    result * 9  # 27
}
